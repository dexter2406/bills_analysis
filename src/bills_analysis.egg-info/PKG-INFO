Metadata-Version: 2.4
Name: bills_analysis
Version: 0.1.0
Summary: Local backend CLI for invoice OCR and extraction PoC
Requires-Python: <3.12,>=3.10
Description-Content-Type: text/markdown
Requires-Dist: typer>=0.12
Requires-Dist: pydantic>=2.6
Requires-Dist: rich>=13.7
Requires-Dist: pymupdf>=1.23
Requires-Dist: pillow>=10.2
Requires-Dist: numpy<2.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.4; extra == "dev"
Provides-Extra: ocr
Requires-Dist: paddleocr>=2.7; extra == "ocr"
Requires-Dist: paddlepaddle>=2.5.0; extra == "ocr"

# bills_analysis

Local backend CLI skeleton for the invoice OCR/extraction PoC.

## Run style
- Preferred: `uv run invoice --help` (uses `pyproject.toml` deps).
- Alt: `python cli/main.py --help` for editable runs without install.

### Python version
- Project targets Python 3.10–3.11 (PaddlePaddle wheels are not available for 3.12/3.13). Create a 3.11 env for OCR work (`uv venv --python 3.11` or `uv run --python 3.11 ...`).

## Dependencies
- PyMuPDF for PDF rendering; Pillow for preprocessing.
- OCR is optional and gated behind extras (PaddleOCR is heavier):
  - Base OCR extra (current env only): `uv sync --current --extra ocr`
  - PaddlePaddle is not bundled; on Windows (Python <3.12), install it manually from the Paddle index:  
    `uv add --current paddlepaddle==2.5.2 --index-url https://www.paddlepaddle.org.cn/whl/windows/mkl/avx/stable.html`  
    then `uv sync --current --extra ocr` (PaddleOCR from PyPI)
  - If you cannot install PaddleOCR/PaddlePaddle, text-layer fallback still works for digitized PDFs but scanning OCR will be unavailable.

## Layout
- `src/bills_analysis/`: core package and `contracts.py` for `extraction.json`.
- `cli/main.py`: local entrypoint that forwards to the Typer app.
- `tests/`: minimal CLI regression placeholder.
- `data/samples/`: drop electronic and scanned PDF fixtures here.
- `outputs/`: runtime artifacts; see `outputs/extraction.example.json` for the contract.

## Usage examples
- Single file stub (renders pages to PNG, OCR-first with text-layer fallback, writes placeholder `extraction.json` + `tokens.json`): `uv run invoice extract data/samples/demo.pdf --out outputs/run1 --dpi 200`
- Force preprocessing even for text-layer PDFs: add `--force-preprocess`.
- Batch stub (multiple inputs accepted): `uv run invoice batch data/samples/digitized data/samples/scan/*.pdf --out outputs/runs --dpi 200`

## Next steps (per PoC)
- Fill the pipeline (render → preprocess → OCR → extract → evidence) inside `src/bills_analysis/`.
- Add golden sample PDFs and expected outputs under `data/samples/` and `tests/`.
